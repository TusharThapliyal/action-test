name: workflow-with-env-variables
on: 
  push
env:
  USERNAME: tusharthapliyal
  PASSWORD: Tushar_docker_8979
  REPO_NAME: action-test
  DOCKER_REGISTERY: docker.io
jobs:
  build:
    runs-on: ubuntu-latest
    steps: 
      -  name: puling nginx
         run: |
           docker pull nginx:latest
           docker image tag nginx:latest $DOCKER_REGISTERY/$USERNAME/$REPO_NAME:latest
  
  login:
    needs: build
    runs-on: ubuntu-latest
    steps:
      -  name: login to docker
         run: docker login -u $USERNAME -p $PASSWORD
  
  push:
    needs: login
    runs-on: ubuntu-latest
    steps:
      -  name: push to docker
         run: docker push $DOCKER_REGISTERY/$USERNAME/$REPO_NAME:latest
